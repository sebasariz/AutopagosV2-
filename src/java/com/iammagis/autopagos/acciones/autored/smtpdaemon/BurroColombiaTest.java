/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package com.iammagis.autopagos.acciones.autored.smtpdaemon;

/**
 *
 * @author sebastianarizmendy
 */
public class BurroColombiaTest {

    static String plantilla = "Mon, 03 Feb 2020 16:43:17 +0000 (GMT)\n"
            + "ARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;\n"
            + " b=gjOMxg2QVFquu3lJqSsga8T6j0CLLTlcY2c+NARZU9EZvtOSK1wPmpR3JPdkW8Wi5GePgj0RCHmDdS3+OotGA0DaL+kJGrHv13GfaM9k31uLEKs0XBtv6dVzn5H2dMB+LQZP4hwsZ45ZTsVirV4JQgTpyn1CWMVxl84023liWs8kGnnxp0fkNMSquvoVxc2vg8Gfx9M6UH+Ih95+IYpmt/VOjXTFQbsYG+Eq9hhRWGI79mqH2e9ZBg8sESm23e5MKO/K5JOq+evsXtK5jH0DAsj4z7CLAECVcIkAnKtcQ0xqhiMAMRD5R6IXQSJFGbHshJw846aFnWmwUy7E5gFIWQ==\n"
            + "ARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;\n"
            + " s=arcselector9901;\n"
            + " h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;\n"
            + " bh=f9Xglisx284XNcuIDMbHQAkxPlYs0egy983vVKmavQM=;\n"
            + " b=TcH57cGzxn8KmOIV+orH9/FnBZKn3PMf1Q6cFF0nEkuRtep8FGtsermXU7XuMmFcQ/XoqgHWoe/k4E15UcygPrcJU+Ji3rJvoog9xeEIF0emvNuwpMHCmqfzhL2lewX2lGQRlye8OF6vKnqenQqqPbARmIb5BAGzeSZE0xKTpc6IbtYUiMD9uesQWo27QxCjaaU8jyjtxF32Dn7yQ8TwfB7GK6VhYN6lUDCLsOXtRTDd7Ed46JTHH0cSLABlSLwKH7V4ksOMGxr8JuxXvrwHIXZRSBqPzX42lhTSzU4CRLtN+zdNfDRj210meXA/i0EPpGKbhWcA4Bu146XUGbQV2g==\n"
            + "ARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass (sender ip is\n"
            + " 200.115.180.34) smtp.rcpttodomain=autopagos.com\n"
            + " smtp.mailfrom=achcolombia.com.co; dmarc=pass (p=none sp=reject pct=100)\n"
            + " action=none header.from=achcolombia.com.co; dkim=none (message not signed);\n"
            + " arc=none\n"
            + "DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=achcolombia.com.co;\n"
            + " s=selector2;\n"
            + " h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;\n"
            + " bh=f9Xglisx284XNcuIDMbHQAkxPlYs0egy983vVKmavQM=;\n"
            + " b=T4H4ynOfi5nXzRV3oD6wfSml9eiiCukDepggTLbgfVSMB1uqQnnn+RnBDqZlJdvAAbXdXkxkZa/8A4Qmn+OB9AFu+b0RYBD9oebuUAvnIY3dvNqnctUot0Yw2vOD9ZQmZO2sWWSrXKr8x1SRLV0IUCFWR0eeaSNkAlSmIcxLq7I=\n"
            + "Received: from DM5PR12CA0007.namprd12.prod.outlook.com (2603:10b6:4:1::17) by\n"
            + " MW2PR12MB2380.namprd12.prod.outlook.com (2603:10b6:907:4::32) with Microsoft\n"
            + " SMTP Server (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id\n"
            + " 15.20.2686.27; Mon, 3 Feb 2020 16:42:51 +0000\n"
            + "Received: from SN1NAM01FT033.eop-nam01.prod.protection.outlook.com\n"
            + " (2a01:111:f400:7e40::207) by DM5PR12CA0007.outlook.office365.com\n"
            + " (2603:10b6:4:1::17) with Microsoft SMTP Server (version=TLS1_2,\n"
            + " cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.2686.28 via Frontend\n"
            + " Transport; Mon, 3 Feb 2020 16:42:51 +0000\n"
            + "Authentication-Results: spf=pass (sender IP is 200.115.180.34)\n"
            + " smtp.mailfrom=achcolombia.com.co; autopagos.com; dkim=none (message not\n"
            + " signed) header.d=none;autopagos.com; dmarc=pass action=none\n"
            + " header.from=achcolombia.com.co;\n"
            + "Received-SPF: Pass (protection.outlook.com: domain of achcolombia.com.co\n"
            + " designates 200.115.180.34 as permitted sender)\n"
            + " receiver=protection.outlook.com; client-ip=200.115.180.34;\n"
            + " helo=SCOBGEXCSNMP01.achcolombia.com.co;\n"
            + "Received: from SCOBGEXCSNMP01.achcolombia.com.co (200.115.180.34) by\n"
            + " SN1NAM01FT033.mail.protection.outlook.com (10.152.64.173) with Microsoft SMTP\n"
            + " Server id 15.20.2686.25 via Frontend Transport; Mon, 3 Feb 2020 16:42:50\n"
            + " +0000\n"
            + "Received: from SCOBGNHOSAPP01 ([172.16.25.65]) by SCOBGEXCSNMP01.achcolombia.com.co with Microsoft SMTPSVC(8.5.9600.16384);\n"
            + "	 Mon, 3 Feb 2020 11:40:27 -0500\n"
            + "MIME-Version: 1.0\n"
            + "From: serviciopse@achcolombia.com.co\n"
            + "To: bancolombia@autopagos.com\n"
            + "Date: 3 Feb 2020 11:42:37 -0500\n"
            + "Subject: =?utf-8?B?Q29uZmlybWFjacOzbiBUcmFuc2FjY2nDs24gQ1VTIDU1Nzgz?=\n"
            + " =?utf-8?B?MjU2NQ==?=\n"
            + "Content-Type: text/html; charset=iso-8859-1\n"
            + "Content-Transfer-Encoding: quoted-printable\n"
            + "Return-Path: serviciopse@achcolombia.com.co\n"
            + "Message-ID: <SCOBGEXCSNMP011vbla01c1d57c@SCOBGEXCSNMP01.achcolombia.com.co>\n"
            + "X-OriginalArrivalTime: 03 Feb 2020 16:40:27.0704 (UTC) FILETIME=[A3F37B80:01D5DAB0]\n"
            + "X-EOPAttributedMessage: 0\n"
            + "X-Forefront-Antispam-Report:\n"
            + "	CIP:200.115.180.34;IPV:CAL;SCL:-1;CTRY:CO;EFV:NLI;SFV:NSPM;SFS:(10019020)(4636009)(346002)(39860400002)(136003)(396003)(376002)(189003)(199004)(186003)(5660300002)(316002)(26005)(70586007)(478600001)(9686003)(70206006)(336012)(224303003)(66574012)(4744005)(2906002)(8936002)(6916009)(81166006)(81156014)(26826003)(356004)(86362001)(6666004);DIR:OUT;SFP:1102;SCL:1;SRVR:MW2PR12MB2380;H:SCOBGEXCSNMP01.achcolombia.com.co;FPR:;SPF:Pass;LANG:es;PTR:InfoDomainNonexistent;MX:1;A:0;\n"
            + "X-MS-PublicTrafficType: Email\n"
            + "X-MS-Office365-Filtering-Correlation-Id: e6f7b392-5311-49ac-dce3-08d7a8c81bbd\n"
            + "X-MS-TrafficTypeDiagnostic: MW2PR12MB2380:\n"
            + "X-Microsoft-Antispam-PRVS:\n"
            + "	<MW2PR12MB2380AE1E3D6D78FA2AD79FC48D000@MW2PR12MB2380.namprd12.prod.outlook.com>\n"
            + "X-MS-Oob-TLC-OOBClassifiers: OLM:1051;\n"
            + "X-Forefront-PRVS: 0302D4F392\n"
            + "X-MS-Exchange-SenderADCheck: 1\n"
            + "X-Microsoft-Antispam: BCL:0;\n"
            + "X-Microsoft-Antispam-Message-Info:\n"
            + "	pJqPL53EPYxm1FDUoFWF1PWLShQNcN6X9CrW6IK551g4mgOCsV2kknU8kz1GStFkmD3kuxEme3QYYiaOt2RREERf5Bw/VMD5CPORBWiLXT/1p0J25r+MHdpDOtFu8N3VQlACYWj8sFtfFK+G/ed4JvyA+Ao51oQgnRcHGYsARwn3SUA57nmV2SyQIDZjkekAQXz5KDW1lDFB1cXBYy5TOakBiWYhlZf5exLNL3VpNE2e1IfmHDFVY5MHTF6T2T8RS3DQHn9y78xcPgLWf/z0dzlVWQ6WUKcrn+CV76hmn95bzW4epOluw5wbot/kjm57EHRmQavLol0Ce+IZHdwjkLErCzM9B39bRSix81A2y8e+/dUL9G7e6/TwE1ToQVIBU/lJZEtG6bq/0g/F2KUi0tkPwdHly3N/vY1GCQ2a1XjuaN+zXmsj0FNISFr74RV0\n"
            + "X-OriginatorOrg: achcolombia.com.co\n"
            + "X-MS-Exchange-CrossTenant-OriginalArrivalTime: 03 Feb 2020 16:42:50.3889\n"
            + " (UTC)\n"
            + "X-MS-Exchange-CrossTenant-Network-Message-Id: e6f7b392-5311-49ac-dce3-08d7a8c81bbd\n"
            + "X-MS-Exchange-CrossTenant-Id: e8944d97-affb-4612-8caf-e343ec7839c6\n"
            + "X-MS-Exchange-CrossTenant-OriginalAttributedTenantConnectingIp: TenantId=e8944d97-affb-4612-8caf-e343ec7839c6;Ip=[200.115.180.34];Helo=[SCOBGEXCSNMP01.achcolombia.com.co]\n"
            + "X-MS-Exchange-CrossTenant-FromEntityHeader: HybridOnPrem\n"
            + "X-MS-Exchange-Transport-CrossTenantHeadersStamped: MW2PR12MB2380\n"
            + "\n"
            + "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"h=\n"
            + "ttp://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">=0D=0A<?x=\n"
            + "ml namespace=3D\"\" prefix=3D\"O\" ?>=0D=0A<p>=0D=0A	<html xmlns=3D\"h=\n"
            + "ttp://www.w3.org/1999/xhtml\" xmlns:o=3D\"\">=0D=0A		<head>=0D=0A		<=\n"
            + "/head>=0D=0A		<body></body>=0D=0A	</html>=0D=0A</p>=0D=0A<p>=0D=0A=\n"
            + "	<title></title>=0D=0A	<style type=3D\"text/css\">=0D=0A.font {=0D=0A=\n"
            + " font-size: 10pt;=0D=0A color:#000000;=0D=0A font-family: Verdana=\n"
            + "=0D=0A}=0D=0A.title {=0D=0A font-size: 12pt;=0D=0A color:#ffffff;=\n"
            + "=0D=0A font-family: Verdana=0D=0A}=0D=0A.title2 {=0D=0A font-size=\n"
            + ": 12pt;=0D=0A color:#000000;=0D=0A font-family: Verdana=0D=0A}	</=\n"
            + "style>=0D=0A</p>=0D=0A<p>=0D=0A	&nbsp;</p>=0D=0A<p>=0D=0A	&nbsp;<=\n"
            + "/p>=0D=0A<p>=0D=0A	&nbsp;</p>=0D=0A<p>=0D=0A	&nbsp;</p>=0D=0A<tab=\n"
            + "le align=3D\"center\" border=3D\"0\" cellpadding=3D\"1\" cellspacing=3D=\n"
            + "\"2\" class=3D\"MsoNormalTable\" style=3D\"width: 60%\" width=3D\"46%\">=0D=0A=\n"
            + "	<thead>=0D=0A		<tr>=0D=0A			<th bgcolor=3D\"#f7ac19\" colspan=3D\"2=\n"
            + "\" height=3D\"1\">=0D=0A				&nbsp;</th>=0D=0A		</tr>=0D=0A		<tr>=0D=0A=\n"
            + "			<th class=3D\"title\" colspan=3D\"2\" height=3D\"40\">=0D=0A				<p a=\n"
            + "lign=3D\"center\" class=3D\"MsoNormal\" style=3D\"text-align: center\">=\n"
            + "=0D=0A					<span class=3D\"formttextocontenio1\"><span style=3D\"fon=\n"
            + "t-family: Verdana; color: #1f52a2; font-size: 12pt\"><strong>Si re=\n"
            + "quiere m&aacute;s informaci&oacute;n acerca de la transacci&oacut=\n"
            + "e;n, por favor contactarse al n&uacute;mero telef&oacute;nico:<st=\n"
            + "rong>3015972588</strong></strong></span></span></p>=0D=0A			</th>=\n"
            + "=0D=0A		</tr>=0D=0A		<tr>=0D=0A			<th bgcolor=3D\"#f7ac19\" colspan=\n"
            + "=3D\"2\" height=3D\"1\">=0D=0A				&nbsp;</th>=0D=0A		</tr>=0D=0A		<tr=\n"
            + ">=0D=0A			<th class=3D\"title\" colspan=3D\"2\" height=3D\"40\">=0D=0A	=\n"
            + "			<p align=3D\"center\" class=3D\"MsoNormal\" style=3D\"text-align: c=\n"
            + "enter\">=0D=0A					<span class=3D\"formttextocontenio1\"><span style=\n"
            + "=3D\"font-family: Verdana; color: #1f52a2; font-size: 12pt\"><stron=\n"
            + "g>TRANSACCI&Oacute;N PSE - PSE PAGOS </strong></span></span><o:p>=\n"
            + "</o:p></p>=0D=0A			</th>=0D=0A		</tr>=0D=0A		<tr>=0D=0A			<th bgc=\n"
            + "olor=3D\"#f7ac19\" class=3D\"title\" colspan=3D\"2\" height=3D\"2\">=0D=0A=\n"
            + "				&nbsp;</th>=0D=0A		</tr>=0D=0A		<tr>=0D=0A			<th bgcolor=3D\"#=\n"
            + "0057a3\" class=3D\"title\" colspan=3D\"2\" height=3D\"40\">=0D=0A				<st=\n"
            + "rong>FORMA DE PAGO</strong></th>=0D=0A		</tr>=0D=0A	</thead>=0D=0A=\n"
            + "	<thead>=0D=0A		<tr>=0D=0A			<th bgcolor=3D\"#cccccc\" class=3D\"tit=\n"
            + "le2\" colspan=3D\"2\" height=3D\"30\">=0D=0A				DATOS DEL PAGO</th>=0D=0A=\n"
            + "		</tr>=0D=0A	</thead>=0D=0A	<tbody>=0D=0A		<tr>=0D=0A			<td clas=\n"
            + "s=3D\"font\" width=3D\"32%\">=0D=0A				<b>Medio de Pago:</b></td>=0D=0A=\n"
            + "			<td class=3D\"font\" width=3D\"68%\">=0D=0A				Pagos ACH PSE</td>=0D=0A=\n"
            + "		</tr>=0D=0A		<tr>=0D=0A			<td bgcolor=3D\"#dedede\" class=3D\"font=\n"
            + "\">=0D=0A				Fecha del Pago:</td>=0D=0A			<td bgcolor=3D\"#dedede\" =\n"
            + "class=3D\"font\">=0D=0A				03/02/2020</td>=0D=0A		</tr>=0D=0A		<tr>=\n"
            + "=0D=0A			<td class=3D\"font\">=0D=0A				Ticket ID:</td>=0D=0A			<td=\n"
            + " class=3D\"font\">=0D=0A				90</td>=0D=0A		</tr>=0D=0A		<tr>=0D=0A	=\n"
            + "		<td bgcolor=3D\"#dedede\" class=3D\"font\">=0D=0A				Transacci&oacu=\n"
            + "te;n/CUS:</td>=0D=0A			<td bgcolor=3D\"#dedede\" class=3D\"font\">=0D=0A=\n"
            + "				557832565</td>=0D=0A		</tr>=0D=0A		<tr>=0D=0A			<td class=3D\"=\n"
            + "font\">=0D=0A				Tipo de usuario:</td>=0D=0A			<td class=3D\"font\">=\n"
            + "=0D=0A				Persona</td>=0D=0A		</tr>=0D=0A		<tr>=0D=0A			<td bgcol=\n"
            + "or=3D\"#dedede\" class=3D\"font\">=0D=0A				Estado Transacci&oacute;n=\n"
            + ":</td>=0D=0A			<td bgcolor=3D\"#dedede\" class=3D\"font\">=0D=0A				T=\n"
            + "ransacci=F3n Rechazada</td>=0D=0A		</tr>=0D=0A		<tr>=0D=0A			<td =\n"
            + "class=3D\"font\">=0D=0A				Concepto:</td>=0D=0A			<td class=3D\"font=\n"
            + "\">=0D=0A				6749_Factura: Prueba BurroColombia Ref: prueba5</td>=0D=0A=\n"
            + "		</tr>=0D=0A		<tr>=0D=0A			<td bgcolor=3D\"#dedede\" class=3D\"font=\n"
            + "\">=0D=0A				Ciclo Transacci&oacute;n:</td>=0D=0A			<td bgcolor=3D=\n"
            + "\"#dedede\" class=3D\"font\">=0D=0A				3</td>=0D=0A		</tr>=0D=0A		<tr=\n"
            + ">=0D=0A			<td class=3D\"font\">=0D=0A				Banco:</td>=0D=0A			<td cl=\n"
            + "ass=3D\"font\">=0D=0A				BANCO DAVIVIENDA</td>=0D=0A		</tr>=0D=0A		=\n"
            + "<tr>=0D=0A			<td bgcolor=3D\"#dedede\" class=3D\"font\">=0D=0A				C&o=\n"
            + "acute;d. de servicio:</td>=0D=0A			<td bgcolor=3D\"#dedede\" class=3D=\n"
            + "\"font\">=0D=0A				1001</td>=0D=0A		</tr>=0D=0A		<tr>=0D=0A			<td c=\n"
            + "lass=3D\"font\">=0D=0A				Total:</td>=0D=0A			<td class=3D\"font\">=0D=0A=\n"
            + "				50</td>=0D=0A		</tr>=0D=0A		<tr>=0D=0A			<td bgcolor=3D\"#dede=\n"
            + "de\" class=3D\"font\">=0D=0A				Total Iva:</td>=0D=0A			<td bgcolor=3D=\n"
            + "\"#dedede\" class=3D\"font\">=0D=0A				0</td>=0D=0A		</tr>=0D=0A	</tb=\n"
            + "ody>=0D=0A	<tbody>=0D=0A		<tr>=0D=0A			<td class=3D\"font\">=0D=0A	=\n"
            + "			No. Pago:</td>=0D=0A			<td class=3D\"font\">=0D=0A				90</td>=0D=0A=\n"
            + "		</tr>=0D=0A	</tbody>=0D=0A</table>=0D=0A<p>=0D=0A	&nbsp;</p>=0D=0A=\n"
            + "<p>=0D=0A	&nbsp;</p>=0D=0A<p>=0D=0A	&nbsp;</p>=0D=0A<p>=0D=0A	&nb=\n"
            + "sp;</p>=0D=0A<p class=3D\"font\" lign=3D\"center\">=0D=0A	* Transacci=\n"
            + "ones sujetas a verificaci&oacute;n</p>=0D=0A<p>=0D=0A	&nbsp;</p>=0D=0A=\n"
            + "<table align=3D\"center\" border=3D\"0\" cellpadding=3D\"1\" cellspacin=\n"
            + "g=3D\"1\" class=3D\"MsoNormalTable\" style=3D\"width: 60%\" width=3D\"70=\n"
            + "%\">=0D=0A</table>=0D=0A";

    public static void main(String[] args) {

        plantilla = plantilla.replaceAll("\n", "").replaceAll("\r", "").replaceAll("\t", "").replaceAll(" ", "").replaceAll("=", "");
        String cus = "";
        if (plantilla.contains("CUS:")) {
            cus = plantilla.split("CUS:</td>0D0A<tdbgcolor3D\"#dedede\"class3D\"font\">0D0A")[1].split("</td>")[0];
        }
        System.out.println("cus: " + cus);
        System.out.println("plantilla: " + plantilla);
        if (plantilla.contains("Concepto:")) {
            String numeroTransaccion = plantilla.split("AConcepto:</td>0D0A<tdclass3D\"font\">0D0A")[1]
                    .split("_")[0].replaceAll("[^\\d.]", "");
            if (numeroTransaccion.contains("_")) {
                numeroTransaccion = numeroTransaccion.split("_")[0];
            }
            System.out.println("idReferencia: " + numeroTransaccion);
        }
    }

}
